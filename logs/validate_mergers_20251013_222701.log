2025-10-13 22:27:01,369 - INFO - ============================================================
2025-10-13 22:27:01,369 - INFO - Validating merger data
2025-10-13 22:27:01,369 - INFO - ============================================================
2025-10-13 22:27:01,369 - INFO - Connecting to database: ../data/swiss_votings.db
2025-10-13 22:27:01,370 - INFO - Finding municipalities with most mergers...
2025-10-13 22:27:01,783 - INFO - Found 2 municipalities with mergers
2025-10-13 22:27:01,783 - INFO - Finding simple cases (no mergers)...
2025-10-13 22:27:02,399 - INFO - Found 3 simple cases
2025-10-13 22:27:02,402 - INFO - 
Selected 5 municipalities for validation:
2025-10-13 22:27:02,402 - INFO -   Complex cases: 2
2025-10-13 22:27:02,402 - INFO -   Simple cases: 3
2025-10-13 22:27:02,402 - INFO - 
Selected municipalities:
2025-10-13 22:27:02,403 - INFO -   Capriasca (BFS 5226): 2 predecessors, depth 2
2025-10-13 22:27:02,403 - INFO -   C'za Corticiasca/Valcolla (BFS 5394): 1 predecessors, depth 1
2025-10-13 22:27:02,403 - INFO -   Aeugst am Albis (BFS 1): 1 predecessors, depth 0
2025-10-13 22:27:02,403 - INFO -   Obfelden (BFS 10): 1 predecessors, depth 0
2025-10-13 22:27:02,403 - INFO -   Stadel (BFS 100): 1 predecessors, depth 0
2025-10-13 22:27:02,403 - INFO - Creating validation report...
2025-10-13 22:27:02,403 - INFO - Analyzing 6 predecessor municipalities
2025-10-13 22:27:02,403 - INFO - Mapping to 5 current municipalities
2025-10-13 22:27:02,403 - INFO - Getting merger timeline...
2025-10-13 22:27:02,404 - INFO - Getting original voting data...
2025-10-13 22:27:02,408 - INFO - Found 1338 original voting records
2025-10-13 22:27:02,408 - INFO - Getting aggregated voting data from views...
2025-10-13 22:27:02,965 - INFO - Found 1115 aggregated voting records
2025-10-13 22:27:03,329 - INFO - 
Saved summary: merger_validation_summary.csv
2025-10-13 22:27:03,329 - INFO - Saved timeline: merger_validation_timeline.csv
2025-10-13 22:27:03,333 - INFO - Saved original data: merger_validation_original.csv
2025-10-13 22:27:03,337 - INFO - Saved aggregated data: merger_validation_aggregated.csv
2025-10-13 22:27:03,341 - INFO - Saved validation comparison: merger_validation_comparison.csv
2025-10-13 22:27:03,341 - INFO - 
============================================================
2025-10-13 22:27:03,341 - INFO - VALIDATION STATISTICS
2025-10-13 22:27:03,341 - INFO - ============================================================
2025-10-13 22:27:03,341 - INFO - Total validation records: 1115
2025-10-13 22:27:03,341 - INFO - Ja stimmen matches: 892 / 1115 (80.0%)
2025-10-13 22:27:03,341 - INFO - Nein stimmen matches: 892 / 1115 (80.0%)
2025-10-13 22:27:03,341 - INFO - Gueltige stimmen matches: 892 / 1115 (80.0%)
2025-10-13 22:27:03,342 - WARNING - 
Found 223 mismatches - check validation_comparison.csv
2025-10-13 22:27:03,342 - WARNING - Sample mismatches:
2025-10-13 22:27:03,342 - WARNING -   Capriasca - Voting 20000312, Proposal 1
2025-10-13 22:27:03,342 - WARNING -     Aggregated: 2091 ja, 201 nein
2025-10-13 22:27:03,342 - WARNING -     Original sum: 1082 ja, 115 nein
2025-10-13 22:27:03,342 - WARNING -   Capriasca - Voting 20000312, Proposal 2
2025-10-13 22:27:03,342 - WARNING -     Aggregated: 872 ja, 1469 nein
2025-10-13 22:27:03,342 - WARNING -     Original sum: 445 ja, 776 nein
2025-10-13 22:27:03,342 - WARNING -   Capriasca - Voting 20000312, Proposal 3
2025-10-13 22:27:03,342 - WARNING -     Aggregated: 478 ja, 1879 nein
2025-10-13 22:27:03,342 - WARNING -     Original sum: 221 ja, 1014 nein
2025-10-13 22:27:03,343 - INFO - 
============================================================
2025-10-13 22:27:03,343 - INFO - SUCCESS!
2025-10-13 22:27:03,343 - INFO - ============================================================
2025-10-13 22:27:03,343 - INFO - 
Generated files:
2025-10-13 22:27:03,343 - INFO -   merger_validation_summary.csv
2025-10-13 22:27:03,343 - INFO -   merger_validation_timeline.csv
2025-10-13 22:27:03,343 - INFO -   merger_validation_original.csv
2025-10-13 22:27:03,343 - INFO -   merger_validation_aggregated.csv
2025-10-13 22:27:03,343 - INFO -   merger_validation_comparison.csv
2025-10-13 22:27:03,343 - INFO - 
Use these files to manually cross-reference:
2025-10-13 22:27:03,343 - INFO -   - Original data shows individual municipalities before merger
2025-10-13 22:27:03,343 - INFO -   - Aggregated data shows combined results after merger
2025-10-13 22:27:03,343 - INFO -   - Comparison shows if sums match correctly
