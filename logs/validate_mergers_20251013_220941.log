2025-10-13 22:09:41,337 - INFO - ============================================================
2025-10-13 22:09:41,338 - INFO - Validating merger data
2025-10-13 22:09:41,338 - INFO - ============================================================
2025-10-13 22:09:41,338 - INFO - Connecting to database: data/swiss_votings.db
2025-10-13 22:09:41,338 - INFO - Finding municipalities with most mergers...
2025-10-13 22:09:41,825 - INFO - Found 2 municipalities with mergers
2025-10-13 22:09:41,825 - INFO - Finding simple cases (no mergers)...
2025-10-13 22:09:42,508 - INFO - Found 3 simple cases
2025-10-13 22:09:42,509 - INFO - 
Selected 5 municipalities for validation:
2025-10-13 22:09:42,509 - INFO -   Complex cases: 2
2025-10-13 22:09:42,509 - INFO -   Simple cases: 3
2025-10-13 22:09:42,509 - INFO - 
Selected municipalities:
2025-10-13 22:09:42,509 - INFO -   Capriasca (BFS 5226): 2 predecessors, depth 2
2025-10-13 22:09:42,509 - INFO -   C'za Corticiasca/Valcolla (BFS 5394): 1 predecessors, depth 1
2025-10-13 22:09:42,509 - INFO -   Aeugst am Albis (BFS 1): 1 predecessors, depth 0
2025-10-13 22:09:42,509 - INFO -   Obfelden (BFS 10): 1 predecessors, depth 0
2025-10-13 22:09:42,509 - INFO -   Stadel (BFS 100): 1 predecessors, depth 0
2025-10-13 22:09:42,509 - INFO - Creating validation report...
2025-10-13 22:09:42,510 - INFO - Analyzing 6 predecessor municipalities
2025-10-13 22:09:42,510 - INFO - Mapping to 5 current municipalities
2025-10-13 22:09:42,510 - INFO - Getting merger timeline...
2025-10-13 22:09:42,510 - INFO - Getting original voting data...
2025-10-13 22:09:42,515 - INFO - Found 1338 original voting records
2025-10-13 22:09:42,515 - INFO - Getting aggregated voting data from views...
2025-10-13 22:09:43,075 - INFO - Found 1115 aggregated voting records
2025-10-13 22:09:43,438 - INFO - 
Saved summary: data/merger_validation_summary.csv
2025-10-13 22:09:43,438 - INFO - Saved timeline: data/merger_validation_timeline.csv
2025-10-13 22:09:43,442 - INFO - Saved original data: data/merger_validation_original.csv
2025-10-13 22:09:43,445 - INFO - Saved aggregated data: data/merger_validation_aggregated.csv
2025-10-13 22:09:43,449 - INFO - Saved validation comparison: data/merger_validation_comparison.csv
2025-10-13 22:09:43,449 - INFO - 
============================================================
2025-10-13 22:09:43,449 - INFO - VALIDATION STATISTICS
2025-10-13 22:09:43,449 - INFO - ============================================================
2025-10-13 22:09:43,449 - INFO - Total validation records: 1115
2025-10-13 22:09:43,449 - INFO - Ja stimmen matches: 892 / 1115 (80.0%)
2025-10-13 22:09:43,449 - INFO - Nein stimmen matches: 892 / 1115 (80.0%)
2025-10-13 22:09:43,450 - INFO - Gueltige stimmen matches: 892 / 1115 (80.0%)
2025-10-13 22:09:43,450 - WARNING - 
Found 223 mismatches - check validation_comparison.csv
2025-10-13 22:09:43,450 - WARNING - Sample mismatches:
2025-10-13 22:09:43,450 - WARNING -   Capriasca - Voting 20000312, Proposal 1
2025-10-13 22:09:43,450 - WARNING -     Aggregated: 2091 ja, 201 nein
2025-10-13 22:09:43,450 - WARNING -     Original sum: 1082 ja, 115 nein
2025-10-13 22:09:43,450 - WARNING -   Capriasca - Voting 20000312, Proposal 2
2025-10-13 22:09:43,450 - WARNING -     Aggregated: 872 ja, 1469 nein
2025-10-13 22:09:43,450 - WARNING -     Original sum: 445 ja, 776 nein
2025-10-13 22:09:43,451 - WARNING -   Capriasca - Voting 20000312, Proposal 3
2025-10-13 22:09:43,451 - WARNING -     Aggregated: 478 ja, 1879 nein
2025-10-13 22:09:43,451 - WARNING -     Original sum: 221 ja, 1014 nein
2025-10-13 22:09:43,451 - INFO - 
============================================================
2025-10-13 22:09:43,451 - INFO - SUCCESS!
2025-10-13 22:09:43,451 - INFO - ============================================================
2025-10-13 22:09:43,451 - INFO - 
Generated files:
2025-10-13 22:09:43,451 - INFO -   data/merger_validation_summary.csv
2025-10-13 22:09:43,451 - INFO -   data/merger_validation_timeline.csv
2025-10-13 22:09:43,451 - INFO -   data/merger_validation_original.csv
2025-10-13 22:09:43,451 - INFO -   data/merger_validation_aggregated.csv
2025-10-13 22:09:43,451 - INFO -   data/merger_validation_comparison.csv
2025-10-13 22:09:43,451 - INFO - 
Use these files to manually cross-reference:
2025-10-13 22:09:43,451 - INFO -   - Original data shows individual municipalities before merger
2025-10-13 22:09:43,451 - INFO -   - Aggregated data shows combined results after merger
2025-10-13 22:09:43,451 - INFO -   - Comparison shows if sums match correctly
